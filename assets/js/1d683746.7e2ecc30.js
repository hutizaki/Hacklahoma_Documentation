"use strict";(globalThis.webpackChunkhacklahoma_documentation=globalThis.webpackChunkhacklahoma_documentation||[]).push([[1154],{5176:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"hacker-portal/deployment-ci/ci-pipeline","title":"CI Pipeline","description":"GitLab CI runs on merge requests and push to main. Stages:","source":"@site/docs/hacker-portal/deployment-ci/ci-pipeline.mdx","sourceDirName":"hacker-portal/deployment-ci","slug":"/hacker-portal/deployment-ci/ci-pipeline","permalink":"/Hacklahoma_Documentation/docs/hacker-portal/deployment-ci/ci-pipeline","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/hacker-portal/deployment-ci/ci-pipeline.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"CI Pipeline","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Production Server","permalink":"/Hacklahoma_Documentation/docs/hacker-portal/deployment-ci/production-server"},"next":{"title":"TEST_PROD and Blue-Green","permalink":"/Hacklahoma_Documentation/docs/hacker-portal/deployment-ci/test-prod-blue-green"}}');var i=t(4848),o=t(8453);const s={title:"CI Pipeline",sidebar_position:1},c="CI Pipeline",l={},a=[];function d(e){const n={a:"a",code:"code",h1:"h1",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ci-pipeline",children:"CI Pipeline"})}),"\n",(0,i.jsxs)(n.p,{children:["GitLab CI runs on merge requests and push to ",(0,i.jsx)(n.code,{children:"main"}),". ",(0,i.jsx)(n.strong,{children:"Stages:"})]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"format"})," \u2014 No npm lockfiles (pnpm only); Prettier on changed files."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"lint"})," \u2014 ESLint and TypeScript on frontend and backend."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"build"})," \u2014 Build frontend and backend Docker images; push to GitLab Container Registry with tag ",(0,i.jsx)(n.code,{children:"sha-<commit>"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"test_unit"})," \u2014 Jest (and Vitest) in parallel; backend uses in-container MongoDB, ",(0,i.jsx)(n.code,{children:"--runInBand"})," to avoid duplicate-key issues."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"test_e2e"})," \u2014 Ephemeral burner stack from built images; Puppeteer/Jest E2E; then teardown."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"publish"})," \u2014 After tests pass, write image digests to artifacts."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"deploy"})," \u2014 ",(0,i.jsxs)(n.strong,{children:["deploy",":test_prod"]})," pulls by digest and runs blue-green rollout for TEST_PROD."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Config: ",(0,i.jsx)(n.code,{children:"config/.env.ci"})," (ports 9080/9081, no real secrets). Full story: ",(0,i.jsx)(n.code,{children:"docs/ci-pipeline.md"}),", ",(0,i.jsx)(n.code,{children:"docs/deployment/docker-stack-isolation-and-ci-testing.md"})," in the repo."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Related:"})," ",(0,i.jsx)(n.a,{href:"/docs/hacker-portal/docker/blue-green",children:"Blue-green deploy"}),", ",(0,i.jsx)(n.a,{href:"/docs/hacker-portal/deployment-ci/test-prod-blue-green",children:"TEST_PROD and blue-green"})]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var r=t(6540);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);